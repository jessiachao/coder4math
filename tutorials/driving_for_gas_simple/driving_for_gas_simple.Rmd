---
title: "Driving for Gas (assessment version)"
output: learnr::tutorial
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(learnr)
knitr::opts_chunk$set(echo = FALSE)

options(tutorial.storage = filesystem_storage("/srv/shiny-server/tutorials/AAA_storage", compress = TRUE))
```


## The Challenge 

Your colleagues have been working on a modeling problem described below:

> Gas prices change on a nearly daily basis, and not every gas station offers the same price for a gallon of gas. The gas station selling the cheapest gas may be across town from where you are driving. Is it worth the drive across town for less expensive gas? Create a mathematical model that can be used to help understand under what conditions it is worth the drive.

## The Model

The R code below is the model your colleagues created. Read the code and run it and answer the questions in the following page.

```{r model, exercise=TRUE, exercise.lines = 35}
# MODEL ----------------------------------------------------------
# Assume the amount of buy
amount = 15       # Amount to buy at either station (gallon)

# Estimate the cost of buying gas at Station 1
price_gs1 = 3.00               # Price at Station 1 (dollar/gallon)
cost_gs1 = price_gs1 * amount  # Cost of buying gas at Station 1 (dollar)

# Estimate the apparent cost of buying gas at Station 2
price_gs2 = 2.75               # Price at Station 2 (dollar/gallon)
cost_gs2 = price_gs2 * amount  # Cost of buying gas at Station 2 (dollar)

# Estimate the cost of driving the additional distance for Station 2
distance_add = 1:30                # Additional distance traveled for Station 2 (1 to 30 miles)
mpg = 25                           # Fuel economy of the car (miles per gallon)
amount_add = distance_add / mpg    # The additional gas used the additional distance (gallon)
cost_add = price_gs2 * amount_add  # The cost of the additional gas (dollar)

# Estimate the real cost of buying gas at Station 2
cost_gs2_real = cost_gs2 + cost_add  # The real cost of buying gas at GS2 (dolloar)

# Compare the costs of buying gas at GS1 versus GS2
difference = cost_gs1 - cost_gs2_real

# REPORT RESULTS ----------------------------------------------------------
# Display the data generated by the model
data.frame(distance_add, cost_gs2_real, difference)

# Impact of additional distance on the real cost of buying gas at GS2 
plot(x = distance_add, y = cost_gs2_real, ylim = c(30, 50))

# Visualize the cost of buying gas at GS1 as a horizontal line
abline(h = cost_gs1)
```

## Walkthrough
```{r walkthrough, exercise=TRUE, exercise.lines = 35}
```

## Understand It
1. How did your colleagues define the phrase “worth the drive” in the problem statement?
<br>

2. What is the main factor that affects which station will be recommended by the model? Explain why the factor is important to include in the model.
<br>

3. Below are some assumptions your colleagues made in order to create the model. Comment on each of them whether they are relevant and reasonable and why you think so.
<br>

    + *The driver will buy the same amount of gas at either station.*
    <br>

    + *The driver recently renewed his or her driver’s license.*
    <br>

    + *The cost of driver’s time is negligible.*
    <br>

4. Based on the model, identify one more assumption you colleagues might have made and comment on its relevance and the reasoning behind it.
<br>

5. Run the model and summarize the model’s results.
<br>

## Improve It
Do you think the results make sense in reality? Which of the definitions and assumptions that your colleagues made were problematic? Describe how you would address the issue.
<br>


Modify the R code to make your model generate more realistic recommendations. Feel free to add new variables and expressions and ask the teacher for coding help.
```{r improve, exercise=TRUE, exercise.lines = 35}

```
